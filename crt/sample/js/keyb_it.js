var alt_remap = 
	[
		/* 000 */ 0000, /* 001 */ 9786, /* 002 */ 9787, /* 003 */ 9829, /* 004 */ 9830, /* 005 */ 9827, /* 006 */ 9824, /* 007 */ 8226, /* 008 */ 9688, /* 009 */ 9675, /* 010 */ 9689, /* 011 */ 9794, /* 012 */ 9792, /* 013 */ 9834, /* 014 */ 9835, /* 015 */ 9788, 
		/* 016 */ 9658, /* 017 */ 9668, /* 018 */ 8597, /* 019 */ 8252, /* 020 */ 182, /* 021 */ 167, /* 022 */ 9644, /* 023 */ 8616, /* 024 */ 8593, /* 025 */ 8595, /* 026 */ 8594, /* 027 */ 8592, /* 028 */ 8735, /* 029 */ 8596, /* 030 */ 9650, /* 031 */ 9660, 
		/* 032 */ 32, /* 033 */ 99, /* 034 */ 34, /* 035 */ 35, /* 036 */ 36, /* 037 */ 37, /* 038 */ 38, /* 039 */ 39, /* 040 */ 40, /* 041 */ 41, /* 042 */ 42, /* 043 */ 43, /* 044 */ 44, /* 045 */ 45, /* 046 */ 46, /* 047 */ 47, 
		/* 048 */ 48, /* 049 */ 49, /* 050 */ 50, /* 051 */ 51, /* 052 */ 52, /* 053 */ 53, /* 054 */ 54, /* 055 */ 55, /* 056 */ 56, /* 057 */ 57, /* 058 */ 58, /* 059 */ 59, /* 060 */ 60, /* 061 */ 61, /* 062 */ 62, /* 063 */ 63, 
		/* 064 */ 64, /* 065 */ 65, /* 066 */ 66, /* 067 */ 67, /* 068 */ 68, /* 069 */ 69, /* 070 */ 70, /* 071 */ 71, /* 072 */ 72, /* 073 */ 73, /* 074 */ 74, /* 075 */ 75, /* 076 */ 76, /* 077 */ 77, /* 078 */ 78, /* 079 */ 79, 
		/* 080 */ 80, /* 081 */ 81, /* 082 */ 82, /* 083 */ 83, /* 084 */ 84, /* 085 */ 85, /* 086 */ 86, /* 087 */ 87, /* 088 */ 88, /* 089 */ 89, /* 090 */ 90, /* 091 */ 91, /* 092 */ 92, /* 093 */ 93, /* 094 */ 94, /* 095 */ 95, 
		/* 096 */ 96, /* 097 */ 97, /* 098 */ 98, /* 099 */ 99, /* 100 */ 100, /* 101 */ 101, /* 102 */ 102, /* 103 */ 103, /* 104 */ 104, /* 105 */ 105, /* 106 */ 106, /* 107 */ 107, /* 108 */ 108, /* 109 */ 109, /* 110 */ 110, /* 111 */ 111, 
		/* 112 */ 112, /* 113 */ 113, /* 114 */ 114, /* 115 */ 115, /* 116 */ 116, /* 117 */ 117, /* 118 */ 118, /* 119 */ 119, /* 120 */ 120, /* 121 */ 121, /* 122 */ 122, /* 123 */ 123, /* 124 */ 124, /* 125 */ 125, /* 126 */ 126, /* 127 */ 8962, 
		/* 128 */ 199, /* 129 */ 252, /* 130 */ 233, /* 131 */ 226, /* 132 */ 228, /* 133 */ 224, /* 134 */ 229, /* 135 */ 231, /* 136 */ 234, /* 137 */ 235, /* 138 */ 232, /* 139 */ 239, /* 140 */ 238, /* 141 */ 236, /* 142 */ 196, /* 143 */ 197, 
		/* 144 */ 201, /* 145 */ 230, /* 146 */ 198, /* 147 */ 244, /* 148 */ 246, /* 149 */ 242, /* 150 */ 251, /* 151 */ 249, /* 152 */ 255, /* 153 */ 214, /* 154 */ 220, /* 155 */ 248, /* 156 */ 163, /* 157 */ 216, /* 158 */ 215, /* 159 */ 402, 
		/* 160 */ 225, /* 161 */ 237, /* 162 */ 243, /* 163 */ 250, /* 164 */ 241, /* 165 */ 209, /* 166 */ 170, /* 167 */ 186, /* 168 */ 191, /* 169 */ 174, /* 170 */ 172, /* 171 */ 189, /* 172 */ 188, /* 173 */ 161, /* 174 */ 171, /* 175 */ 187, 
		/* 176 */ 9617, /* 177 */ 9618, /* 178 */ 9619, /* 179 */ 9474, /* 180 */ 9508, /* 181 */ 193, /* 182 */ 194, /* 183 */ 192, /* 184 */ 169, /* 185 */ 9571, /* 186 */ 9553, /* 187 */ 9559, /* 188 */ 9565, /* 189 */ 162, /* 190 */ 165, /* 191 */ 9488, 
		/* 192 */ 9492, /* 193 */ 9524, /* 194 */ 9516, /* 195 */ 9500, /* 196 */ 9472, /* 197 */ 9532, /* 198 */ 227, /* 199 */ 195, /* 200 */ 9562, /* 201 */ 9556, /* 202 */ 9577, /* 203 */ 9574, /* 204 */ 9568, /* 205 */ 9552, /* 206 */ 9580, /* 207 */ 164, 
		/* 208 */ 240, /* 209 */ 208, /* 210 */ 202, /* 211 */ 203, /* 212 */ 200, /* 213 */ 305, /* 214 */ 205, /* 215 */ 206, /* 216 */ 207, /* 217 */ 9496, /* 218 */ 9484, /* 219 */ 9608, /* 220 */ 9604, /* 221 */ 166, /* 222 */ 204, /* 223 */ 9600, 
		/* 224 */ 211, /* 225 */ 223, /* 226 */ 212, /* 227 */ 210, /* 228 */ 245, /* 229 */ 213, /* 230 */ 181, /* 231 */ 254, /* 232 */ 222, /* 233 */ 218, /* 234 */ 219, /* 235 */ 217, /* 236 */ 253, /* 237 */ 221, /* 238 */ 175, /* 239 */ 180, 
		/* 240 */ 173, /* 241 */ 177, /* 242 */ 8215, /* 243 */ 190, /* 244 */ 182, /* 245 */ 167, /* 246 */ 247, /* 247 */ 184, /* 248 */ 176, /* 249 */ 168, /* 250 */ 183, /* 251 */ 185, /* 252 */ 179, /* 253 */ 178, /* 254 */ 9632, /* 255 */ 160
	];

var keyboard_layout = function(e)
	{
	
		if (/* e.keyb.BROWSER == e.keyb.B_FIREFOX && */ e.code)
			{
				switch((e.code + '').toLowerCase())
					{
						case 'minus':
							e.kcode = 219;
							break;
						case 'equal':
							e.kcode = 221;
							break;
						case 'bracketleft':
							e.kcode = 186;
							break;
						case 'bracketright':
							e.kcode = 187;
							break;
						case 'semicolon':
							e.kcode = 192;
							break;
						case 'quote':
							e.kcode = 222;
							break;
						case 'backslash':
							e.kcode = 191;
							break;
						case 'slash':
							e.kcode = 189;
							break;
						case 'intlbackslash':
							e.kcode = 226;
							break;
					}
			}
	
		//log(e.kcode)
		switch (e.kcode)
			{
				case 16:
					return K_SHIFT;
				case 17:
					return K_CTRL;
				case 18:
					return K_ALT;
				case 91:
					return K_SUPER;
				case 93:
					return K_MENU;
				case 27:
					return K_ESC;
				case 112:
					return K_F1;
				case 113:
					return K_F2;
				case 114:
					return K_F3;
				case 115:
					return K_F4;
				case 116:
					return K_F5;
				case 117:
					return K_F6;
				case 118:
					return K_F7;
				case 119:
					return K_F8;
				case 120:
					return K_F9;
				case 121:
					return K_F10;
				case 122:
					return K_F11;
				case 123:
					return K_F12;
				case 145:
					return K_SCROLL;
				case 19:
					return K_PAUSE;
				case 20:
					return K_CAPS;
				case 220:
					if (e.shiftKey) return '|'; else return '\\';
				case 219:
					if (e.shiftKey) return '?'; else return '\'';
				case 221:
					if (e.shiftKey) return '^'; else return String.fromCharCode(141);
				case 8:
					return K_BS;
				case 9:
					return K_TAB;
				case 186:
					if (e.shiftKey && !e.ctrlKey && !e.altKey) 
						return String.fromCharCode(130); 
					else 
						if (e.ctrlKey && e.altKey && !e.shiftKey)
							return '[';
						else
							if (e.ctrlKey && e.altKey && e.shiftKey)
								return '{';
							else
								return String.fromCharCode(138);
				case 187:
					if (e.shiftKey && !e.ctrlKey && !e.altKey) 
						return '*'; 
					else 
						if (e.ctrlKey && e.altKey && !e.shiftKey)
							return ']';
						else
							if (e.ctrlKey && e.altKey && e.shiftKey)
								return '}';
							else
								return '+';
				case 192:
					if (e.shiftKey && !e.ctrlKey && !e.altKey) 
						return String.fromCharCode(135); 
					else 
						if (e.ctrlKey && e.altKey && !e.shiftKey)
							return '@';
						else
							return String.fromCharCode(149);
				case 222:
					if (e.shiftKey && !e.ctrlKey && !e.altKey) 
						return String.fromCharCode(248); 
					else 
						if (e.ctrlKey && e.altKey && !e.shiftKey)
							return '#';
						else
							return String.fromCharCode(133);
				case 191:
					if (e.shiftKey) 
						return String.fromCharCode(21); 
					else 
						return String.fromCharCode(151);
				case 226:
					if (e.shiftKey) 
						return '>'; 
					else 
						return '<';
				case 188:
					if (e.shiftKey) 
						return ';'; 
					else 
						return ',';
				case 190:
					if (e.shiftKey) 
						return ':'; 
					else 
						return '.';
				case 189:
					if (e.shiftKey) 
						return '_'; 
					else 
						return '-';
				case 45:
					return K_INS;
				case 36:
					return K_HOME;
				case 33:
					return K_PGUP;
				case 46:
					return K_DEL;
				case 35:
					return K_END;
				case 34:
					return K_PGDOWN;
				case 37:
					return K_LEFT;
				case 39:
					return K_RIGHT;
				case 38:
					return K_UP;
				case 40:
					return K_DOWN;
				case 144:
					return K_NUM;
				case 111:
					return K_PAD_DIV;
				case 106:
					return K_PAD_MUL;
				case 107:
					return K_PAD_PLUS;
				case 109:
					return K_PAD_MIN;
				case 13:
					return K_ENTER;
				case 103:
					return K_PAD_7;
				case 104:
					return K_PAD_8;
				case 105:
					return K_PAD_9;
				case 100:
					return K_PAD_4;
				case 101:
					return K_PAD_5;
				case 102:
					return K_PAD_6;
				case 97:
					return K_PAD_1;
				case 98:
					return K_PAD_2;
				case 99:
					return K_PAD_3;
				case 96:
					return K_PAD_0;
				case 110:
					return K_PAD_DIGITAL;
				case 12:
					return K_FORM_FEED;
			}
			
		switch (e.character)
			{
				case '1':
					if (e.shiftKey) return '!'; else return '1';
				case '2':
					if (e.shiftKey) return '"'; else return '2';
				case '3':
					if (e.shiftKey) return String.fromCharCode(156); else return '3';
				case '4':
					if (e.shiftKey) return '$'; else return '4';
				case '5':
					if (e.shiftKey) return '%'; else return '5';
				case '6':
					if (e.shiftKey) return '&'; else return '6';
				case '7':
					if (e.shiftKey) return '/'; else return '7';
				case '8':
					if (e.shiftKey) return '('; else return '8';
				case '9':
					if (e.shiftKey) return ')'; else return '9';
				case '0':
					if (e.shiftKey) return '='; else return '0';
			}
			
		if (e.shiftKey)	return e.character.toUpperCase(); else return e.character;
	}

var keyboard_layout_it = keyboard_layout;